<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	font-weight:normal;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"Comment Text Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
p
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
pre
	{mso-style-link:"HTML Preformatted Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-link:"Comment Subject Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.Code, li.Code, div.Code
	{mso-style-name:Code;
	mso-style-link:"Code Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	background:#D9D9D9;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
span.CodeChar
	{mso-style-name:"Code Char";
	mso-style-link:Code;
	font-family:"Times New Roman",serif;
	background:#D9D9D9;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Calibri Light",sans-serif;
	letter-spacing:-.5pt;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-link:"HTML Preformatted";
	font-family:"Courier New";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma",sans-serif;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-link:"Comment Text";}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-link:"Comment Subject";
	font-weight:bold;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:107%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-AU link=blue vlink="#954F72">

<div class=WordSection1>

<p class=MsoTitle>How to Build Card Reader</p>

<p class=MsoNormal>&nbsp;</p>

<h1>Overview:</h1>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:10.0pt;margin-left:
0cm'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;color:black'>Card
Reader is an application that demonstrates how to capture Media Elements from a
live camera feed in order to create a new contact. This extracts the text and
integrates it into the Windows People App using OCR. </span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:10.0pt;margin-left:
0cm'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;color:black'>This
application tutorial is broken up into the following exercises:</span></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-18.0pt'><span
style='font-size:10.0pt;line-height:107%'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Setup a Windows 10 Universal Application using Visual Studio
Community edition 2015.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'><span
style='font-size:10.0pt;line-height:107%'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Use an embedded/external camera in order to capture Media using
MediaCapture API.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Xaml elements and Code Behind Events in order to find cameras</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Connect to selected camera</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Display the camera feed.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'><span
style='font-size:10.0pt;line-height:107%'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Extract text from an image using the Optical Character
Recognition (OCR) library.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-18.0pt'><span
style='font-size:10.0pt;line-height:107%'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Integrate with the Windows People App.</p>

<p class=MsoNormal>The application allows the user to detect and select the
connected Media devices. In order to begin the Media Capture exercise, there
needs to be at least one (1) camera device connected or embedded. </p>

<p class=MsoNormal><b>Note: In order to get correct text recognition, you will
need to use a HD camera, embedded or external.</b></p>

<p class=MsoNormal>The application utilises the MediaCapture API and OCR
Library in order to capture pictures from a live camera feed and extract text
from the images. It also uses the ContactManager API to integrate with the
People App. This document will explain how to setup all the components required
for you to build this yourself</p>

<span style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<h1>Getting Started:</h1>

<p class=MsoNormal>In order to build and test this project you will need some
experience with C# and XAML. You will need to use a Windows 10 machine running
Visual Studio 2015 (Community Edition or greater) when building this app.</p>

<p class=MsoNormal>Create a new Universal Application</p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='font-size:10.0pt;color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Open Visual Studio 2015 and select <b>File
| New | Project</b> (CTRL + SHIFT + N)</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='font-size:10.0pt;color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>This will open a “New Project” window.
Navigate to Templates | Visual C# and</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='font-size:10.0pt;color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Choose Blank App (Universal Apps) and
Name your application CardReader</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'><img width=480 height=332 id="Picture 1"
src="How%20To%20Build%20Card%20Reader_files/image001.jpg"
alt="Machine generated alternative text:&#10;New Project &#10;Installed &#10;Templates &#10;visual &#10;Windows &#10;Wlndows 8 &#10;Classic Desktop &#10;Android &#10;Cloud &#10;Extensibility &#10;Silver-light &#10;Workflow &#10;.NET Framework 45.2 &#10;Sort by. Default &#10;Blank App (Universal Windows) &#10;Class Library (Universal Windows) &#10;Windows Runtime Component (Universal Windows) &#10;unit Test App (Universal Windows) &#10;Coded UI Test Project (Windows Phone) &#10;Coded UI Test Project (Windows) &#10;Click here to go online and find templates. &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Search Installed Templates (Ctrl*E) &#10;Type: Visual &#10;A project for a single-page Universal &#10;Windows Platform app that has no &#10;predefined controls or layout. &#10;Show telemetry in the Windows Dev &#10;Enable richer analytics with &#10;Application Insights &#10;Learn more &#10;Privacy sta tement &#10;Create directory for solution &#10;Add to source control &#10;t' Visual Basic &#10;Visual &#10;Visual C++ &#10;t' Online &#10;Name: &#10;Solution name: &#10;CardReade &#10;c:XGitxcardReader &#10;Card Reader "></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='font-size:10.0pt;color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Build and Run the new Application (F5),
you should see a blank window on the screen. Close the Application.</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='font-size:10.0pt;color:black'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Before you begin to write any code you
need to setup some capabilities of the application. To change capabilities in a
Windows 10 universal application open the Package.appxmanifest file which you
can find in the Solution Explorer of Visual Studio. Go to the
&quot;Capabilities&quot; tab and select <span style='background:yellow'>Microphone</span>,
<span style='background:yellow'>Webcam</span> and <span style='background:yellow'>Pictures
Library</span>.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'><img width=576 height=429 id="Picture 2"
src="How%20To%20Build%20Card%20Reader_files/image002.jpg"
alt="Machine generated alternative text:&#10;CardReader - Microsoft Visual Studio &#10;Edit View Project Build Debug Team &#10;Debug &#10;Tools &#10;Test &#10;Analyze Window Help &#10;Local Machine • E&quot; &#10;Package.appxmanifest -E X &#10;Quick Launch (Ctrl+Q &#10;p &#10;Sign in &#10;The properties of the deployment package for your app are contained in the app manifest file. You can use the Manifest Designer to set or modify one or more of the properties. &#10;Application &#10;Visual Assets &#10;Capabilities &#10;Declarations &#10;Content URIS &#10;Packaging &#10;Use this page to specify system features or devices that your app can use. &#10;Capabilities: &#10;All Joyn &#10;Blocked Chat Messages &#10;Bluetooth &#10;Chat Message Access &#10;Code Generation &#10;Enterprise Authentication &#10;Internet (Client) &#10;Internet (Client &amp; Server) &#10;Location &#10;Microphone &#10;Music Library &#10;Objects 3D &#10;Phone Call &#10;Pictures Library &#10;Private Networks (Client &amp; Server) &#10;Proximity &#10;Removable Storage &#10;Shared User Certificates &#10;User Account Information &#10;Videos Library &#10;VOIP Calling &#10;Webcam &#10;Output &#10;Descript ion: &#10;Provides the capability to add, change, or delete files in the Pictures Library for the local PC and &#10;HomeGroup PCs. &#10;More information "></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<span style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<h1>Exercise 1 - Basic Structure and using an Embedded/External Camera:</h1>

<p class=MsoNormal>In this exercise you will be setting up a list of all
attached and currently running cameras. You will then display a camera preview
for a chosen camera.</p>

<p class=MsoListParagraph style='text-indent:-18.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Start by setting up a basic interface in MainPage.xaml. In the Solution
Explorer double click on MainPage.xaml.  Inside the Grid add the following XAML.<br>
You will be adding to this XAML throughout the hands on lab.</p>

<p class=Code><span style='color:blue'>&lt;</span><span style='color:#A31515'>Grid</span>
Background<span style='color:blue'>=&quot;{</span><span style='color:#A31515'>ThemeResource</span>
ApplicationPageBackgroundThemeBrush<span style='color:blue'>}&quot;&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                       </span><span
style='color:blue;background:yellow'>&lt;</span><span style='color:#A31515;
background:yellow'>StackPanel</span><span style='background:yellow'>
Orientation<span style='color:blue'>=&quot;Vertical&quot;</span>
HorizontalAlignment<span style='color:blue'>=&quot;Center&quot;&gt;</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:blue;background:yellow'>&lt;</span><span style='color:#A31515;
background:yellow'>TextBlock</span><span style='background:yellow'> Text<span
style='color:blue'>=&quot;Card Reader&quot;</span> Margin<span
style='color:blue'>=&quot;4&quot;</span> FontSize<span style='color:blue'>=&quot;28&quot;</span>
HorizontalAlignment<span style='color:blue'>=&quot;Center&quot;/&gt;</span></span></p>

<p class=Code><span style='color:black;background:yellow'> </span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:green;background:yellow'>&lt;!-- Camera Selection --&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:blue;background:yellow'>&lt;</span><span style='color:#A31515;
background:yellow'>TextBlock</span><span style='background:yellow'> Text<span
style='color:blue'>=&quot;Select a Camera&quot;</span> Margin<span
style='color:blue'>=&quot;4&quot;</span> HorizontalAlignment<span
style='color:blue'>=&quot;Center&quot;/&gt;</span></span></p>

<p class=Code><span style='color:black;background:yellow'> </span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:blue;background:yellow'>&lt;</span><span style='color:#A31515;
background:yellow'>ListView</span><span style='background:yellow'> x<span
style='color:blue'>:</span>Name<span style='color:blue'>=&quot;CameraSelectionList&quot;</span>
Margin<span style='color:blue'>=&quot;4&quot;</span> Width<span
style='color:blue'>=&quot;240&quot; </span>MaxHeight<span style='color:blue'>=&quot;200&quot;</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                        
</span><span style='background:yellow'> SelectionChanged<span style='color:
blue'>=&quot;CameraSelectionList_SelectionChanged&quot;</span><span
style='color:black'> </span></span></p>

<p class=Code><span style='color:black;background:yellow'>                        
</span><span style='background:yellow'> HorizontalAlignment<span
style='color:blue'>=&quot;Center&quot;/&gt;</span></span></p>

<p class=Code><span style='color:black;background:yellow'>            </span><span
style='color:blue;background:yellow'>&lt;/</span><span style='color:#A31515;
background:yellow'>StackPanel</span><span style='color:blue;background:yellow'>&gt;</span></p>

<p class=Code><span style='color:black'>    </span><span style='color:blue'>&lt;/</span><span
style='color:#A31515'>Grid</span><span style='color:blue'>&gt;</span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Press
F7 or hit the little arrow next to MainPage.xaml in the Solution Explorer to
navigate to MainPage.xaml.cs. In here create a method handler for the camera
selection changed event</p>

<p class=Code>public<span style='color:black'> </span>sealed<span
style='color:black'> </span>partial<span style='color:black'> </span>class<span
style='color:black'> </span><span style='color:#2B91AF'>MainPage</span><span
style='color:black'> : </span><span style='color:#2B91AF'>Page</span></p>

<p class=Code><span style='color:black'>    {</span></p>

<p class=Code><span style='color:black'>        </span>public<span
style='color:black'> MainPage()</span></p>

<p class=Code><span style='color:black'>        {</span></p>

<p class=Code><span style='color:black'>            </span>this<span
style='color:black'>.InitializeComponent();</span></p>

<p class=Code><span style='color:black'>        }</span></p>

<p class=Code><span style='color:black'> </span></p>

<p class=Code><span style='color:black'>        </span><span style='background:
yellow'>private<span style='color:black'> </span>void<span style='color:black'>
CameraSelectionList_SelectionChanged(</span>object<span style='color:black'>
sender, </span><span style='color:#2B91AF'>SelectionChangedEventArgs</span><span
style='color:black'> e)</span></span></p>

<p class=Code><span style='color:black;background:yellow'>        {</span></p>

<p class=Code><span style='color:black;background:yellow'>        }</span></p>

<p class=Code><span style='color:black'>    }</span></p>

<p class=MsoListParagraph style='text-indent:-18.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Next implement the camera device list. Create a new private variable at
the top of MainPage.xaml.cs to hold the list of camera devices. In the constructor
register a handler for the Loaded event.</p>

<p class=Code><span style='color:blue;background:yellow'>using</span><span
style='background:yellow'> Windows.Devices.Enumeration;</span></p>

<p class=Code>&nbsp;</p>

<p class=Code>public<span style='color:black'> </span>sealed<span
style='color:black'> </span>partial<span style='color:black'> </span>class<span
style='color:black'> </span><span style='color:#2B91AF'>MainPage</span><span
style='color:black'> : </span><span style='color:#2B91AF'>Page</span></p>

<p class=Code><span style='color:black'>    {</span></p>

<p class=Code><span style='color:black'>        </span><span style='background:
yellow'>private<span style='color:black'> </span><span style='color:#2B91AF'>DeviceInformationCollection</span><span
style='color:black'> _allVideoDevices;</span></span></p>

<p class=Code><span style='color:black'> </span></p>

<p class=Code><span style='color:black'>        </span>public<span
style='color:black'> MainPage()</span></p>

<p class=Code><span style='color:black'>        {</span></p>

<p class=Code><span style='color:black'>            </span>this<span
style='color:black'>.InitializeComponent();</span></p>

<p class=Code><span style='color:black'>            </span><span
style='background:yellow'>this<span style='color:black'>.Loaded +=
MainPage_Loaded;</span></span></p>

<p class=Code><span style='color:black'>        }</span></p>

<p class=Code><span style='color:black'> </span></p>

<p class=Code><span style='color:black'>        </span><span style='background:
yellow'>private<span style='color:black'> </span>void<span style='color:black'>
MainPage_Loaded(</span>object<span style='color:black'> sender, </span><span
style='color:#2B91AF'>RoutedEventArgs</span><span style='color:black'> e)</span></span></p>

<p class=Code><span style='color:black;background:yellow'>        {</span></p>

<p class=Code><span style='color:black;background:yellow'>        }</span></p>

<p class=Code><span style='color:black'> </span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span>void<span style='color:black'> CameraSelectionList_SelectionChanged(</span>object<span
style='color:black'> sender, </span><span style='color:#2B91AF'>SelectionChangedEventArgs</span><span
style='color:black'> e)</span></p>

<p class=Code><span style='color:black'>        {</span></p>

<p class=Code><span style='color:black'>        }</span></p>

<p class=Code><span style='color:black'>    }</span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpLast>Inside the Loaded event handler add the
following code to populate the camera device list. You will need to make the Loaded
method async as the code uses await on other async method calls.</p>

<p class=Code><span style='color:blue;background:yellow'>using</span><span
style='background:yellow'> System.Linq;</span></p>

<p class=Code>&nbsp;</p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue;
background:yellow'>async</span> <span style='color:blue'>void</span>
MainPage_Loaded(<span style='color:blue'>object</span> sender, <span
style='color:#2B91AF'>RoutedEventArgs</span> e)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:green;background:yellow'>// Get
available devices for capturing media and list them </span></p>

<p class=Code><span style='background:yellow'>            _allVideoDevices = <span
style='color:blue'>await</span> <span style='color:#2B91AF'>DeviceInformation</span>.FindAllAsync(<span
style='color:#2B91AF'>DeviceClass</span>.VideoCapture);</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>if</span> (_allVideoDevices == <span style='color:blue'>null</span>
|| !_allVideoDevices.Any())</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:#2B91AF'>Debug</span>.WriteLine(<span style='color:#A31515'>&quot;No
devices found.&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>return</span>;</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:green'>//add to  device list</span></span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>foreach</span> (<span style='color:#2B91AF'>DeviceInformation</span>
camera <span style='color:blue'>in</span> _allVideoDevices)</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>if</span> (CameraSelectionList.Items != <span
style='color:blue'>null</span>)</span></p>

<p class=Code><span style='background:yellow'>                {</span></p>

<p class=Code><span style='background:yellow'>                   
CameraSelectionList.Items.Add(camera.Name);</span></p>

<p class=Code><span style='background:yellow'>                }</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code>        }</p>

<p class=MsoListParagraph>&nbsp;</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt;text-indent:-18.0pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>Build and Run the App. At the top under the text &quot;Select a
Camera&quot; you will now see the available devices. </span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>If you do not have a camera available, this list will be empty.
Please refer to the images below</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'><img width=235 height=80 id="Picture 10"
src="How%20To%20Build%20Card%20Reader_files/image003.png"></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>No camera device found</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'><img width=250 height=119 id="Picture 11"
src="How%20To%20Build%20Card%20Reader_files/image004.png"></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>One camera device found</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'><img width=242 height=223 id="Picture 13"
src="How%20To%20Build%20Card%20Reader_files/image005.png"></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>Multiple camera devices found</span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Implement the Camera Selection Changed
event. This will have a trigger to output the camera feed to the
&quot;previewElement&quot;.  </span><span style='color:black'>This event is
called &quot;SelectionChanged&quot;.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>You will
need a new variable to store the selected camera. Add this at the top of
MainPage.xaml.cs class</span></p>

<p class=Code>public<span style='color:black'> </span>sealed<span
style='color:black'> </span>partial<span style='color:black'> </span>class<span
style='color:black'> </span><span style='color:#2B91AF'>MainPage</span><span
style='color:black'> : </span><span style='color:#2B91AF'>Page</span></p>

<p class=Code><span style='color:black'>    {</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>DeviceInformationCollection</span><span
style='color:black'> _allVideoDevices;</span></p>

<p class=Code><span style='color:black'>        </span><span style='background:
yellow'>private<span style='color:black'> </span><span style='color:#2B91AF'>DeviceInformation</span><span
style='color:black'> _desiredDevice;</span></span></p>

<p class=MsoNormal style='margin-left:18.0pt'>&nbsp;</p>

<p class=MsoListParagraph>In the Camera Selection Changed method you created earlier
add the following code. This will get the selected device from the list and set
it as the desired device. You may have noticed the commented out line that
calls a method “StartDeviceAsync”. This does not exist but is the next thing
you will need to implement.</p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue'>void</span>
CameraSelectionList_SelectionChanged(<span style='color:blue'>object</span>
sender, <span style='color:#2B91AF'>SelectionChangedEventArgs</span> e)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:blue;background:yellow'>string</span><span
style='background:yellow'> selectedCameraItem =
e.AddedItems.FirstOrDefault().ToString();</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>foreach</span> (<span style='color:#2B91AF'>DeviceInformation</span>
item <span style='color:blue'>in</span> _allVideoDevices)</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>if</span> (<span style='color:blue'>string</span>.Equals(item.Name,
selectedCameraItem))</span></p>

<p class=Code><span style='background:yellow'>                {</span></p>

<p class=Code><span style='background:yellow'>                   
_desiredDevice = item;</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:green'>//await StartDeviceAsync();</span></span></p>

<p class=Code><span style='background:yellow'>                }</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code>        }</p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>To connect to the selected camera and
start that cameras video feed</span><span style='color:black'> you need to
create a new asynchronous method called StartDeviceAsync.  Create a new private
variable at the top of the class that will contain the instance of a media
capture device. </span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue;background:yellow'>using</span><span
style='background:yellow'> Windows.Media.Capture;</span></p>

<p class=Code>&nbsp;</p>

<p class=Code><span style='color:blue'>public</span> <span style='color:blue'>sealed</span>
<span style='color:blue'>partial</span> <span style='color:blue'>class</span> <span
style='color:#2B91AF'>MainPage</span> : <span style='color:#2B91AF'>Page</span></p>

<p class=Code>    {</p>

<p class=Code>        <span style='color:blue'>private</span> <span
style='color:#2B91AF'>DeviceInformationCollection</span> _allVideoDevices;</p>

<p class=Code>        <span style='color:blue'>private</span> <span
style='color:#2B91AF'>DeviceInformation</span> _desiredDevice;</p>

<p class=Code>        <span style='color:blue;background:yellow'>private</span><span
style='background:yellow'> <span style='color:#2B91AF'>MediaCapture</span> _mediaCapture;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>At
the bottom of the MainPage.xaml.cs class add a new region called
Camera_Methods. This will allow you to maintain cleaner code.</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=Code><span style='color:gray;background:yellow'>#region</span><span
style='background:yellow'> Camera_Methods</span></p>

<p class=Code><span style='background:yellow'>       <span style='color:gray'>#endregion</span></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>Inside the
new region add the new StartDeviceAsync method. You will notice there are a few
lines that are currently commented out. You will come back to these later on
this lab.</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue;background:yellow'>private</span><span
style='background:yellow'> <span style='color:blue'>async</span> Task
StartDeviceAsync()</span></p>

<p class=Code><span style='background:yellow'>        {</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>if</span> (_desiredDevice != <span style='color:blue'>null</span>)</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>try</span></span></p>

<p class=Code><span style='background:yellow'>                {</span></p>

<p class=Code><span style='background:yellow'>                   
Debug.WriteLine(<span style='color:#A31515'>&quot;Starting&nbsp;device&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'>                    _mediaCapture
= <span style='color:blue'>new</span> <span style='color:#2B91AF'>MediaCapture</span>();</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:green'>//initialize&nbsp;the&nbsp;selected&nbsp;device</span></span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>await</span> _mediaCapture.InitializeAsync(</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:blue'>new</span> <span style='color:#2B91AF'>MediaCaptureInitializationSettings</span></span></p>

<p class=Code><span style='background:yellow'>                        {</span></p>

<p class=Code><span style='background:yellow'>                           
VideoDeviceId = _desiredDevice.Id</span></p>

<p class=Code><span style='background:yellow'>                        });</span></p>

<p class=Code><span style='background:yellow'>                    </span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:green'>// if you have a valid camera then enable the photo button
and start the preview window display</span></span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>if</span> (_mediaCapture.MediaCaptureSettings.VideoDeviceId
!= <span style='color:blue'>string</span>.Empty</span></p>

<p class=Code><span style='background:yellow'>                       
&amp;&amp; _mediaCapture.MediaCaptureSettings.AudioDeviceId != <span
style='color:blue'>string</span>.Empty)</span></p>

<p class=Code><span style='background:yellow'>                    {</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:green'>//TakePhotoButton.IsEnabled = true;</span></span></p>

<p class=Code><span style='background:yellow'>                       
Debug.WriteLine(<span style='color:#A31515'>&quot;Device&nbsp;initialized&nbsp;successful&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:green'>//await StartPreviewAsync();</span></span></p>

<p class=Code><span style='background:yellow'>                    }</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>else</span></span></p>

<p class=Code><span style='background:yellow'>                    {</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:green'>//TakePhotoButton.IsEnabled = false;</span></span></p>

<p class=Code><span style='background:yellow'>                       
Debug.WriteLine(<span style='color:#A31515'>&quot;Error -
No&nbsp;VideoDevice/AudioDevice&nbsp;Found&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'>                    }</span></p>

<p class=Code><span style='background:yellow'>                }</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>catch</span> (Exception exception)</span></p>

<p class=Code><span style='background:yellow'>                {</span></p>

<p class=Code><span style='background:yellow'>                    Debug.WriteLine(exception);</span></p>

<p class=Code><span style='background:yellow'>                }</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code><span style='background:yellow'>        }</span></p>

<p class=MsoListParagraph style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt;text-indent:-18.0pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:black'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>The StartDeviceAsync method needs to be called inside the
SelectionChanged method, this is where a camera is selected. In the
SeletionChanged method uncomment the “await StartDeviceAsync()” line. As you
are now awaiting the method you will need to make this method async.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue;
background:yellow'>async</span> <span style='color:blue'>void</span>
CameraSelectionList_SelectionChanged(<span style='color:blue'>object</span>
sender, <span style='color:#2B91AF'>SelectionChangedEventArgs</span> e)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:blue'>string</span>
selectedCameraItem = e.AddedItems.FirstOrDefault().ToString();</p>

<p class=Code>            <span style='color:blue'>foreach</span> (<span
style='color:#2B91AF'>DeviceInformation</span> item <span style='color:blue'>in</span>
_allVideoDevices)</p>

<p class=Code>            {</p>

<p class=Code>                <span style='color:blue'>if</span> (<span
style='color:blue'>string</span>.Equals(item.Name, selectedCameraItem))</p>

<p class=Code>                {</p>

<p class=Code>                    _desiredDevice = item;</p>

<p class=Code>                    <span style='color:blue;background:yellow'>await</span><span
style='background:yellow'> StartDeviceAsync();</span></p>

<p class=Code>                }</p>

<p class=Code>            }</p>

<p class=Code>        }</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt;text-indent:-18.0pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:black'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>To display the selected camera feed in a CaptureElement add the
following XAML to MainPage.xaml underneath the CameraSelection</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='background:yellow'>&lt;!-- Camera Preview and Take
Photo Button --&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:blue;background:yellow'>&lt;</span><span style='color:#A31515;
background:yellow'>TextBlock</span><span style='color:red;background:yellow'>
Text</span><span style='color:blue;background:yellow'>=&quot;Camera
Preview&quot;</span><span style='color:red;background:yellow'> Margin</span><span
style='color:blue;background:yellow'>=&quot;4&quot;</span><span
style='color:red;background:yellow'> HorizontalAlignment</span><span
style='color:blue;background:yellow'>=&quot;Center&quot;/&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:blue;background:yellow'>&lt;</span><span style='color:#A31515;
background:yellow'>Border</span><span style='color:red;background:yellow'>
Background</span><span style='color:blue;background:yellow'>=&quot;LightSlateGray&quot;&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                    </span><span
style='color:blue;background:yellow'>&lt;</span><span style='color:#A31515;
background:yellow'>CaptureElement</span><span style='color:red;background:yellow'>
x</span><span style='color:blue;background:yellow'>:</span><span
style='color:red;background:yellow'>Name</span><span style='color:blue;
background:yellow'>=&quot;PreviewElement&quot;</span><span style='color:red;
background:yellow'> Width</span><span style='color:blue;background:yellow'>=&quot;240&quot;</span><span
style='color:red;background:yellow'> Height</span><span style='color:blue;
background:yellow'>=&quot;240&quot; /&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:blue;background:yellow'>&lt;/</span><span style='color:#A31515;
background:yellow'>Border</span><span style='color:blue;background:yellow'>&gt;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>In the MainPage.xaml.cs file create a new method called
StartPreviewAsync inside the Camera_Methods region.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue;background:yellow'>private</span><span
style='background:yellow'> <span style='color:blue'>async</span> Task
StartPreviewAsync()</span></p>

<p class=Code><span style='background:yellow'>        {</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>try</span></span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                Debug.WriteLine(<span
style='color:#A31515'>&quot;Starting&nbsp;preview&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:green'>//set&nbsp;the&nbsp;source&nbsp;to&nbsp;the&nbsp;camera&nbsp;feed</span></span></p>

<p class=Code><span style='background:yellow'>               
PreviewElement.Source = _mediaCapture;</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>await</span> _mediaCapture.StartPreviewAsync();</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>                Debug.WriteLine(<span
style='color:#A31515'>&quot;Start&nbsp;preview&nbsp;successful&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>catch</span> (Exception exception)</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>               
PreviewElement.Source = <span style='color:blue'>null</span>;</span></p>

<p class=Code><span style='background:yellow'>               
Debug.WriteLine(exception);</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code><span style='background:yellow'>        }</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt;text-indent:-18.0pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:black'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>Call the StartPreviewAsync method from the StartDeviceAsync method,
uncomment the “await StartPreviewAsync()” line.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue'>async</span>
Task StartDeviceAsync()</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:blue'>if</span> (_desiredDevice !=
<span style='color:blue'>null</span>)</p>

<p class=Code>            {</p>

<p class=Code>                <span style='color:blue'>try</span></p>

<p class=Code>                {</p>

<p class=Code>                    Debug.WriteLine(<span style='color:#A31515'>&quot;Starting&nbsp;device&quot;</span>);</p>

<p class=Code>                    _mediaCapture = <span style='color:blue'>new</span>
<span style='color:#2B91AF'>MediaCapture</span>();</p>

<p class=Code> </p>

<p class=Code>                    <span style='color:green'>//initialize&nbsp;the&nbsp;selected&nbsp;device</span></p>

<p class=Code>                    <span style='color:blue'>await</span>
_mediaCapture.InitializeAsync(</p>

<p class=Code>                        <span style='color:blue'>new</span> <span
style='color:#2B91AF'>MediaCaptureInitializationSettings</span></p>

<p class=Code>                        {</p>

<p class=Code>                            VideoDeviceId = _desiredDevice.Id</p>

<p class=Code>                        });</p>

<p class=Code>                    </p>

<p class=Code>                    <span style='color:green'>// if you have a
valid camera then enable the photo button and start the preview window display</span></p>

<p class=Code>                    <span style='color:blue'>if</span>
(_mediaCapture.MediaCaptureSettings.VideoDeviceId != <span style='color:blue'>string</span>.Empty</p>

<p class=Code>                        &amp;&amp;
_mediaCapture.MediaCaptureSettings.AudioDeviceId != <span style='color:blue'>string</span>.Empty)</p>

<p class=Code>                    {</p>

<p class=Code>                        <span style='color:green'>//TakePhotoButton.IsEnabled
= true;</span></p>

<p class=Code>                        Debug.WriteLine(<span style='color:#A31515'>&quot;Device&nbsp;initialized&nbsp;successful&quot;</span>);</p>

<p class=Code>                        <span style='color:blue;background:yellow'>await</span><span
style='background:yellow'> StartPreviewAsync();</span></p>

<p class=Code>                    }</p>

<p class=Code>                    <span style='color:blue'>else</span></p>

<p class=Code>                    {</p>

<p class=Code>                        <span style='color:green'>//TakePhotoButton.IsEnabled
= false;</span></p>

<p class=Code>                        Debug.WriteLine(<span style='color:#A31515'>&quot;Error
- No&nbsp;VideoDevice/AudioDevice&nbsp;Found&quot;</span>);</p>

<p class=Code>                    }</p>

<p class=Code>                }</p>

<p class=Code>                <span style='color:blue'>catch</span> (Exception
exception)</p>

<p class=Code>                {</p>

<p class=Code>                    Debug.WriteLine(exception);</p>

<p class=Code>                }</p>

<p class=Code>            }</p>

<p class=Code>        }</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt;text-indent:-18.0pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:black'>10.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>Build and run the application, select a camera and place a
business card in front of the camera the output will show on the screen and
should be similar to this:</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'><img width=527 height=396 id="Picture 15"
src="How%20To%20Build%20Card%20Reader_files/image006.jpg"></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoListParagraph style='text-indent:-18.0pt'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>To capture an image
from the feed when your business card is in focus create a Button in
MainPage.xaml named “Take Photo”.  Also add an Image element to display the
image. Put these underneath the camera preview area</p>

<p class=Code><span style='background:yellow'>&lt;<span style='color:#A31515'>Button</span><span
style='color:red'> x</span>:<span style='color:red'>Name</span>=&quot;TakePhotoButton&quot;<span
style='color:red'> Click</span>=&quot;TakePhotoButton_ClickAsync&quot;<span
style='color:black'> </span></span></p>

<p class=Code><span style='color:black;background:yellow'>                       </span><span
style='color:red;background:yellow'> IsEnabled</span><span style='background:
yellow'>=&quot;False&quot;<span style='color:red'> Margin</span>=&quot;5&quot;<span
style='color:red'> Width</span>=&quot;240&quot;</span></p>

<p class=Code><span style='color:black;background:yellow'>                      
</span><span style='color:red;background:yellow'> Content</span><span
style='background:yellow'>=&quot;Take Photo&quot; /&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span></p>

<p class=Code><span style='color:black;background:yellow'> </span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:green;background:yellow'>&lt;!-- Captured Image from Camera Feed
--&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='background:yellow'>&lt;<span style='color:#A31515'>TextBlock</span><span
style='color:red'> Text</span>=&quot;Captured Images&quot;<span
style='color:red'> HorizontalAlignment</span>=&quot;Center&quot;/&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='background:yellow'>&lt;<span style='color:#A31515'>Border</span><span
style='color:red'> Background</span>=&quot;LightSlateGray&quot;&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                    </span><span
style='background:yellow'>&lt;<span style='color:#A31515'>Image</span><span
style='color:red'> x</span>:<span style='color:red'>Name</span>=&quot;ImageElement&quot;<span
style='color:red'> Width</span>=&quot;240&quot;<span style='color:red'> Height</span>=&quot;240&quot;/&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='background:yellow'>&lt;/<span style='color:#A31515'>Border</span>&gt;</span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpLast>In MainPage.xaml.cs create the click event
handler for the TakePhoto button. Add this underneath the camera selection
method.</p>

<p class=Code><span style='color:blue;background:yellow'>private</span><span
style='background:yellow'> <span style='color:blue'>async</span> <span
style='color:blue'>void</span> TakePhotoButton_ClickAsync(<span
style='color:blue'>object</span> sender, <span style='color:#2B91AF'>RoutedEventArgs</span>
e)</span></p>

<p class=Code><span style='background:yellow'>        {</span></p>

<p class=Code><span style='background:yellow'>        }</span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-18.0pt'>12.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>The Take Photo button
click event handler should capture an image from the camera feed and place the
image in the “ImageElement” you just created. To get an image from the camera
feed you will also need to create a method called OpenImageAsBitmap.<br>
Create a new region called Helper_Methods,  and inside add the new method
called OpenImageAsBitmap which will get the image from the camera feed. </p>

<p class=Code><span style='color:blue'>using</span> Windows.Storage;</p>

<p class=Code><span style='color:blue'>using</span> Windows.Storage.Streams;</p>

<p class=Code><span style='color:blue'>using</span>
Windows.UI.Xaml.Media.Imaging;</p>

<p class=Code>&nbsp;</p>

<p class=Code><span style='color:gray;background:yellow'>#region</span><span
style='background:yellow'> Helper_Methods</span></p>

<p class=Code><span style='background:yellow'>        <span style='color:green'>//open
an image file as a bitmapimage object </span></span></p>

<p class=Code><span style='background:yellow'>        <span style='color:blue'>private</span>
<span style='color:blue'>async</span> <span style='color:#2B91AF'>Task</span>&lt;<span
style='color:#2B91AF'>BitmapImage</span>&gt; OpenImageAsBitmapAsync(<span
style='color:#2B91AF'>StorageFile</span> file)</span></p>

<p class=Code><span style='background:yellow'>        {</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:#2B91AF'>IRandomAccessStreamWithContentType</span> stream = <span
style='color:blue'>await</span> file.OpenReadAsync();</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:#2B91AF'>BitmapImage</span> bmpImg = <span style='color:blue'>new</span>
<span style='color:#2B91AF'>BitmapImage</span>();</span></p>

<p class=Code><span style='background:yellow'>           
bmpImg.SetSource(stream);</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>return</span> bmpImg;</span></p>

<p class=Code><span style='background:yellow'>        } </span></p>

<p class=Code><span style='color:gray;background:yellow'>#endregion</span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-18.0pt'>13.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>To implement the take
photo method add namespace references and a new private variable to store the
image. </p>

<p class=Code><span style='color:blue'>using</span> System.Threading.Tasks;</p>

<p class=Code><span style='color:blue'>using</span>
Windows.Media.MediaProperties; </p>

<p class=Code>&nbsp;</p>

<p class=Code>public<span style='color:black'> </span>sealed<span
style='color:black'> </span>partial<span style='color:black'> </span>class<span
style='color:black'> </span><span style='color:#2B91AF'>MainPage</span><span
style='color:black'> : </span><span style='color:#2B91AF'>Page</span></p>

<p class=Code><span style='color:black'>    {</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>DeviceInformationCollection</span><span
style='color:black'> _allVideoDevices;</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>DeviceInformation</span><span
style='color:black'> _desiredDevice;</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>MediaCapture</span><span
style='color:black'> _mediaCapture;</span></p>

<p class=Code><span style='color:black'>        </span><span style='background:
yellow'>private<span style='color:black'> </span><span style='color:#2B91AF'>StorageFile</span><span
style='color:black'> _photoFile;</span></span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpLast>Update the TakePhotoButton_Click method to be
async to enable it to create an image from the camera feed and save it in the
photoFile using awaited async calls. You will call the OpenImageAsBitmap method
in this step. This method will open the photo file and read it as a BitmapImage,
then set it as the source of the image element in XAML.</p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue;
background:yellow'>async</span> <span style='color:blue'>void</span>
TakePhotoButton_ClickAsync(<span style='color:blue'>object</span> sender, <span
style='color:#2B91AF'>RoutedEventArgs</span> e)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:blue;background:yellow'>try</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:#2B91AF'>Debug</span>.WriteLine(<span style='color:#A31515'>&quot;Taking
photo&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'>               
TakePhotoButton.IsEnabled = <span style='color:blue'>false</span>;</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:green'>//store the captured image</span></span></p>

<p class=Code><span style='background:yellow'>                _photoFile = <span
style='color:blue'>await</span> <span style='color:#2B91AF'>KnownFolders</span>.PicturesLibrary.CreateFileAsync(<span
style='color:#A31515'>&quot;capturedImage&quot;</span>, <span style='color:
#2B91AF'>CreationCollisionOption</span>.ReplaceExisting);</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:#2B91AF'>Debug</span>.WriteLine(<span style='color:#A31515'>&quot;Create
photo file successful&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:green'>//create the properties to write </span></span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:#2B91AF'>ImageEncodingProperties</span> imageProperties = <span
style='color:#2B91AF'>ImageEncodingProperties</span>.CreateJpeg();</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>await</span>
_mediaCapture.CapturePhotoToStorageFileAsync(imageProperties, _photoFile);</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>               
TakePhotoButton.IsEnabled = <span style='color:blue'>true</span>;</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:#2B91AF'>Debug</span>.WriteLine(<span style='color:#A31515'>&quot;Photo
taken&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:green'>//map the captured image as Bitmap image to the right
column</span></span></p>

<p class=Code><span style='background:yellow'>               
ImageElement.Source = <span style='color:blue'>await</span>
OpenImageAsBitmapAsync(_photoFile);</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>catch</span> (<span style='color:#2B91AF'>Exception</span>
exception)</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:#2B91AF'>Debug</span>.WriteLine(exception);</span></p>

<p class=Code><span style='background:yellow'>               
TakePhotoButton.IsEnabled = <span style='color:blue'>true</span>;</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code>        }</p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'>14.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>You may have noticed
that the Take Photo button is disabled by default. The Button will need to be
switched between enabled and disabled to allow the processing of an image, and
prevent the user from interrupting the start-up of the device feed. </p>

<p class=MsoListParagraphCxSpLast>In the StartDeviceAsync method uncomment the
two lines that are setting the TakePhotoButton IsEnabled property.</p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue'>async</span>
<span style='color:#2B91AF'>Task</span> StartDeviceAsync()</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:blue'>if</span> (_desiredDevice !=
<span style='color:blue'>null</span>)</p>

<p class=Code>            {</p>

<p class=Code>                <span style='color:blue'>try</span></p>

<p class=Code>                {</p>

<p class=Code>                    <span style='color:#2B91AF'>Debug</span>.WriteLine(<span
style='color:#A31515'>&quot;Starting&nbsp;device&quot;</span>);</p>

<p class=Code>                    _mediaCapture = <span style='color:blue'>new</span>
<span style='color:#2B91AF'>MediaCapture</span>();</p>

<p class=Code> </p>

<p class=Code>                    <span style='color:green'>//initialize&nbsp;the&nbsp;selected&nbsp;device</span></p>

<p class=Code>                    <span style='color:blue'>await</span>
_mediaCapture.InitializeAsync(</p>

<p class=Code>                        <span style='color:blue'>new</span> <span
style='color:#2B91AF'>MediaCaptureInitializationSettings</span></p>

<p class=Code>                        {</p>

<p class=Code>                            VideoDeviceId = _desiredDevice.Id</p>

<p class=Code>                        });</p>

<p class=Code>                    </p>

<p class=Code>                    <span style='color:green'>// if you have a
valid camera then enable the photo button and start the preview window display</span></p>

<p class=Code>                    <span style='color:blue'>if</span> (_mediaCapture.MediaCaptureSettings.VideoDeviceId
!= <span style='color:blue'>string</span>.Empty</p>

<p class=Code>                        &amp;&amp;
_mediaCapture.MediaCaptureSettings.AudioDeviceId != <span style='color:blue'>string</span>.Empty)</p>

<p class=Code>                    {</p>

<p class=Code>                        <span style='background:yellow'>TakePhotoButton.IsEnabled
= <span style='color:blue'>true</span>;</span></p>

<p class=Code>                        <span style='color:#2B91AF'>Debug</span>.WriteLine(<span
style='color:#A31515'>&quot;Device&nbsp;initialized&nbsp;successful&quot;</span>);</p>

<p class=Code>                        <span style='color:blue'>await</span>
StartPreviewAsync();</p>

<p class=Code>                    }</p>

<p class=Code>                    <span style='color:blue'>else</span></p>

<p class=Code>                    {</p>

<p class=Code>                        <span style='background:yellow'>TakePhotoButton.IsEnabled
= <span style='color:blue'>false</span>;</span></p>

<p class=Code>                        <span style='color:#2B91AF'>Debug</span>.WriteLine(<span
style='color:#A31515'>&quot;Error -
No&nbsp;VideoDevice/AudioDevice&nbsp;Found&quot;</span>);</p>

<p class=Code>                    }</p>

<p class=Code>                }</p>

<p class=Code>                <span style='color:blue'>catch</span> (<span
style='color:#2B91AF'>Exception</span> exception)</p>

<p class=Code>                {</p>

<p class=Code>                    <span style='color:#2B91AF'>Debug</span>.WriteLine(exception);</p>

<p class=Code>                }</p>

<p class=Code>            }</p>

<p class=Code>        }</p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'>15.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Build and run the
application (F5), select a camera and then click “Take Photo” and this should
be the output.</p>

<p class=MsoListParagraphCxSpLast><img width=602 height=452 id="Picture 16"
src="How%20To%20Build%20Card%20Reader_files/image007.jpg"><br clear=all
style='page-break-before:always'>
</p>

<h1>Exercise 2 – Extract Text from an Image using OCR Library:</h1>

<p class=MsoListParagraphCxSpFirst>In this exercise you will be implementing
text recognition. You will start by configuring an OCR engine, which will be
used to retrieve an OCR result from an image.</p>

<p class=MsoListParagraphCxSpMiddle><b>NOTE</b>: For OCR to work you will need
a good camera, with the ability to auto focus. Many laptop webcams do not have
short range focus that will work for OCR. An external camera such as the
Microsoft LifeCam Cinema will work well.</p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>In
MainPage.xaml.cs add a reference to new namespaces and create a new private
variable for the OCR engine.</p>

<p class=Code><span style='color:blue;background:yellow'>using</span><span
style='background:yellow'> Windows.Globalization;</span></p>

<p class=Code><span style='color:blue;background:yellow'>using</span><span
style='background:yellow'> Windows.Media.Ocr;</span></p>

<p class=Code>&nbsp;</p>

<p class=Code>public<span style='color:black'> </span>sealed<span
style='color:black'> </span>partial<span style='color:black'> </span>class<span
style='color:black'> </span><span style='color:#2B91AF'>MainPage</span><span
style='color:black'> : </span><span style='color:#2B91AF'>Page</span></p>

<p class=Code><span style='color:black'>    {</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>DeviceInformationCollection</span><span
style='color:black'> _allVideoDevices;</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>DeviceInformation</span><span
style='color:black'> _desiredDevice;</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>MediaCapture</span><span
style='color:black'> _mediaCapture;</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>StorageFile</span><span
style='color:black'> _photoFile;</span></p>

<p class=Code><span style='color:black'>        </span><span style='background:
yellow'>private<span style='color:black'> </span><span style='color:#2B91AF'>OcrEngine</span><span
style='color:black'> _ocrEngine;</span></span></p>

<p class=Code><span style='color:black'> </span></p>

<p class=Code><span style='color:black'>        </span>public<span
style='color:black'> MainPage()</span></p>

<p class=Code><span style='color:black'>        {</span></p>

<p class=Code><span style='color:black'>            </span>this<span
style='color:black'>.InitializeComponent();</span></p>

<p class=Code><span style='color:black'>            </span>this<span
style='color:black'>.Loaded += MainPage_Loaded;</span></p>

<p class=Code><span style='color:black'> </span></p>

<p class=Code><span style='color:black'>            </span><span
style='color:green;background:yellow'>// Init OCR engine with English language.</span></p>

<p class=Code><span style='color:black;background:yellow'>            _ocrEngine
= </span><span style='color:#2B91AF;background:yellow'>OcrEngine</span><span
style='color:black;background:yellow'>.TryCreateFromLanguage(</span><span
style='background:yellow'>new<span style='color:black'> Language(</span><span
style='color:#A31515'>&quot;en&quot;</span><span style='color:black'>));</span></span><span
style='color:black'> </span></p>

<p class=Code><span style='color:black'>        }</span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>In
MainPage.xaml create a button to trigger getting an OCR result, and a TextBlock
to display an error. Open the MainPage.xaml and add the following XAML
underneath the ImageElement.</p>

<p class=Code><span style='background:yellow'>&lt;!-- OCR Get Details Button
and Results TextBlock --&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:blue;background:yellow'>&lt;</span><span style='color:#A31515;
background:yellow'>Button</span><span style='color:red;background:yellow'> x</span><span
style='color:blue;background:yellow'>:</span><span style='color:red;background:
yellow'>Name</span><span style='color:blue;background:yellow'>=&quot;GetDetailsButton&quot;</span><span
style='color:red;background:yellow'> Click</span><span style='color:blue;
background:yellow'>=&quot;GetDetailsButton_ClickAsync&quot;</span><span
style='color:black;background:yellow'> </span></p>

<p class=Code><span style='color:black;background:yellow'>                      
</span><span style='color:red;background:yellow'> Margin</span><span
style='color:blue;background:yellow'>=&quot;4&quot;</span><span
style='color:red;background:yellow'> Width</span><span style='color:blue;
background:yellow'>=&quot;240&quot;</span><span style='color:red;background:
yellow'> Content</span><span style='color:blue;background:yellow'>=&quot;Get
Details&quot; /&gt;</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:blue;background:yellow'>&lt;</span><span style='color:#A31515;
background:yellow'>TextBlock</span><span style='color:red;background:yellow'> x</span><span
style='color:blue;background:yellow'>:</span><span style='color:red;background:
yellow'>Name</span><span style='color:blue;background:yellow'>=&quot;GetDetailsErrorTextBlock&quot;</span><span
style='color:red;background:yellow'> Foreground</span><span style='color:blue;
background:yellow'>=&quot;Red&quot;</span><span style='color:red;background:
yellow'> HorizontalAlignment</span><span style='color:blue;background:yellow'>=&quot;Center&quot;/&gt;</span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpLast>In MainPage.xaml.cs at the bottom of the
class add the following method to handle the button click event of the
GetDetailsButton.</p>

<p class=Code><span style='color:blue;background:yellow'>private</span><span
style='background:yellow'> <span style='color:blue'>void</span>
GetDetailsButton_ClickAsync(<span style='color:blue'>object</span> sender, <span
style='color:#2B91AF'>RoutedEventArgs</span> e)</span></p>

<p class=Code><span style='background:yellow'>        {</span></p>

<p class=Code><span style='background:yellow'>        }</span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle>In MainPage.xaml.cs you need to implement the
code for the GetDetailsButton click event. The GetDetails method will need to
be changed to be async as it will be awaiting the OCR result. This event
creates a BitmapDecoder which returns a string. You will also create a method
called ApplyPatternMatching which you will put into a new region that contains
OCR specific methods.</p>

<p class=MsoListParagraphCxSpLast>Add a new region called “OCR_Methods”. Inside
this new region add the ApplyPatternMatching method. </p>

<p class=Code><span style='color:gray;background:yellow'>#region</span><span
style='background:yellow'> OCR_Methods</span></p>

<p class=Code><span style='background:yellow'>        <span style='color:blue'>private</span>
<span style='color:blue'>void</span> ApplyPatternMatching(<span
style='color:#2B91AF'>OcrResult</span> ocrResult)</span></p>

<p class=Code><span style='background:yellow'>        {</span></p>

<p class=Code><span style='background:yellow'>        }</span></p>

<p class=Code><span style='background:yellow'>        <span style='color:gray'>#endregion</span></span></p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Implement
the code in the GetDetailsButton_ClickAsync method using the
ApplyPatternMatching method. An error will be displayed to the user if the text
is not recognizable. </p>

<p class=Code><span style='color:blue;background:yellow'>using</span><span
style='background:yellow'> Windows.Graphics.Imaging;</span></p>

<p class=Code><span style='color:blue'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue;
background:yellow'>async</span> <span style='color:blue'>void</span>
GetDetailsButton_ClickAsync(<span style='color:blue'>object</span> sender, <span
style='color:#2B91AF'>RoutedEventArgs</span> e)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='background:yellow'>GetDetailsErrorTextBlock.Text
= <span style='color:blue'>string</span>.Empty;</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>if</span> (_photoFile != <span style='color:blue'>null</span>)</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>using</span> (<span style='color:#2B91AF'>IRandomAccessStream</span>
stream = <span style='color:blue'>await</span> _photoFile.OpenAsync(<span
style='color:#2B91AF'>FileAccessMode</span>.Read))</span></p>

<p class=Code><span style='background:yellow'>                {</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:green'>// Create image decoder.</span></span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:#2B91AF'>BitmapDecoder</span> decoder = <span style='color:blue'>await</span>
<span style='color:#2B91AF'>BitmapDecoder</span>.CreateAsync(stream);</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:green'>// Load bitmap.</span></span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:#2B91AF'>SoftwareBitmap</span> bitmap = <span style='color:blue'>await</span>
decoder.GetSoftwareBitmapAsync();</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:green'>// Extract text from image.</span></span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:#2B91AF'>OcrResult</span> result = <span style='color:blue'>await</span>
_ocrEngine.RecognizeAsync(bitmap);</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>if</span> (<span style='color:blue'>string</span>.IsNullOrEmpty(result.Text))</span></p>

<p class=Code><span style='background:yellow'>                    {</span></p>

<p class=Code><span style='background:yellow'>                       
GetDetailsErrorTextBlock.Text = <span style='color:#A31515'>&quot;Text not
Recognizable try again!&quot;</span>;</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:#2B91AF'>Debug</span>.WriteLine(<span style='color:#A31515'>&quot;The
Text is not recognizable.&quot;</span>);</span></p>

<p class=Code><span style='background:yellow'>                    }</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>else</span></span></p>

<p class=Code><span style='background:yellow'>                    {</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:#2B91AF'>Debug</span>.WriteLine(result.Text);</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:green'>//extract the details</span></span></p>

<p class=Code><span style='background:yellow'>                       
ApplyPatternMatching(result);</span></p>

<p class=Code><span style='background:yellow'>                    }</span></p>

<p class=Code><span style='background:yellow'>                }</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code>        }</p>

<p class=MsoListParagraphCxSpFirst>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Create a new class that will contain an
enum  of Recognition types for the OCR engine. </span><span lang=EN-US
style='color:black'>In Solution Explorer, right click on the project, select <b>Add</b>
| <b>Class</b> from the popup menu. Name the class RecognitionType.cs and click
Add.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'><img
width=601 height=417 id="Picture 7"
src="How%20To%20Build%20Card%20Reader_files/image008.png"></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='color:black'>Change the class definition
to be public enum and add in the enum types.</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>namespace</span> CardReader</p>

<p class=Code>{</p>

<p class=Code>    <span style='color:blue;background:yellow'>public</span><span
style='background:yellow'> <span style='color:blue'>enum</span></span> <span
style='color:#2B91AF'>RecognitionType</span></p>

<p class=Code>    {</p>

<p class=Code>        <span style='background:yellow'>Other,</span></p>

<p class=Code><span style='background:yellow'>        Email,</span></p>

<p class=Code><span style='background:yellow'>        WebPage,</span></p>

<p class=Code><span style='background:yellow'>        Name,</span></p>

<p class=Code><span style='background:yellow'>        Number</span></p>

<p class=Code>    }</p>

<p class=Code>}</p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Create another class with methods to
find patterns in the words extracted by the OCR decoder. </span><span
lang=EN-US style='color:black'>In Solution Explorer, right click on the
project, select <b>Add</b> | <b>Class</b> from the popup menu. Name the class
CardRecognizer.cs and click Add.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'><img width=480 height=331 id="Picture 9"
src="How%20To%20Build%20Card%20Reader_files/image009.jpg"
alt="Machine generated alternative text:&#10;Add New Item - CardReader &#10;Installed &#10;Visual C' &#10;General &#10;Web &#10;D Online &#10;Card Recogniser.cs &#10;Name: &#10;Sort by: Default &#10;XAML View &#10;Blank Page &#10;Content Dialog &#10;Resource Dictionary &#10;Temp la ted Control &#10;user Control &#10;Class &#10;Interface &#10;Application Manifest File &#10;Assembly Information File &#10;Class Diagram &#10;Code Analysis Rule Set &#10;Click here to qo online and find templates. &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Visual C# &#10;Search Installed Templates (Ctrl*E) &#10;Type: Visual &#10;An empty class definition &#10;Cancel "></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span lang=EN-US style='font-size:11.0pt;font-family:
"Calibri",sans-serif;color:black'>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span lang=EN-US
style='color:black'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='color:black'>Change </span><span
lang=EN-US style='color:black'>the CardRecognizer class definition so that it
is a public static class</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:Consolas;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>namespace</span> CardReader</p>

<p class=Code>{</p>

<p class=Code>    <span style='color:blue;background:yellow'>public</span><span
style='background:yellow'> <span style='color:blue'>static</span></span> <span
style='color:blue'>class</span> <span style='color:#2B91AF'>CardRecognizer</span></p>

<p class=Code>    {</p>

<p class=Code>    }</p>

<p class=Code>}</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span lang=EN-US style='font-size:11.0pt;font-family:
"Calibri",sans-serif;color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:22.25pt;margin-bottom:.0001pt;text-indent:-18.0pt;line-height:normal;
vertical-align:middle'><span lang=EN-US style='color:black'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:black'>In the Card Recognizer class add a new private
static Dictionary variable named expressions, this dictionary will map the
types with the corresponding Regex expressions. </span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span lang=EN-US style='font-size:11.0pt;font-family:
"Calibri",sans-serif;color:black'>Regex represents immutable regular
expressions which you can browse or create your own if you follow the link
included.  </span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span lang=EN-US style='font-size:11.0pt;font-family:
"Calibri",sans-serif;color:black'>When you create this new Dictionary you will
need to assign a regex value to the RecognitionType of Email, WebPage and Name
and Number. </span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span lang=EN-US style='font-size:11.0pt;font-family:
"Calibri",sans-serif;color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><i><span lang=EN-US style='font-size:11.0pt;font-family:
"Calibri",sans-serif;color:black'>Note that you are using Patterns here, such
as email, webpage, name and numbers. You are able to create your own patterns
or follow the already existing ones.</span></i></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span lang=EN-US style='font-size:11.0pt;font-family:
"Calibri",sans-serif;color:black'>&nbsp;</span></p>

<p class=Code>public<span style='color:black'> </span>static<span
style='color:black'> </span>class<span style='color:black'> </span><span
style='color:#2B91AF'>CardRecognizer</span></p>

<p class=Code><span style='color:black'>    {</span></p>

<p class=Code><span style='color:black'>        </span><span style='color:blue;
background:yellow'>public</span><span style='color:black;background:yellow'> </span><span
style='color:blue;background:yellow'>static</span><span style='color:black;
background:yellow'> </span><span style='background:yellow'>Dictionary<span
style='color:black'>&lt;</span>RecognitionType<span style='color:black'>, </span><span
style='color:blue'>string</span><span style='color:black'>&gt; expressions = </span><span
style='color:blue'>new</span><span style='color:black'> </span>Dictionary<span
style='color:black'>&lt;</span>RecognitionType<span style='color:black'>, </span><span
style='color:blue'>string</span><span style='color:black'>&gt;()</span></span></p>

<p class=Code><span style='color:black;background:yellow'>        {  </span></p>

<p class=Code><span style='color:black;background:yellow'>            </span><span
style='color:green;background:yellow'>// regex taken from MSDN:
http://msdn.microsoft.com/en-us/library/01escwtf(v=vs.110).aspx  </span></p>

<p class=Code><span style='color:black;background:yellow'>            {</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='background:yellow'>RecognitionType<span style='color:black'>.Email,</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:maroon;background:yellow'>@&quot;^(?(&quot;&quot;)(&quot;&quot;.+?(?&lt;!\\)&quot;&quot;@)|(([0-9a-z]((\.(?!\.))|[-!#\$%&amp;'\*\+/=\?\^`\{\}\|~\w])*)(?&lt;=[0-9a-z])@))&quot;</span><span
style='color:black;background:yellow'>+</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:maroon;background:yellow'>@&quot;(?(\[)(\[(\d{1,3}\.){3}\d{1,3}\])|(([0-9a-z][-\w]*[0-9a-z]*\.)+[a-z0-9][\-a-z0-9]{0,22}[a-z0-9]))$&quot;</span></p>

<p class=Code><span style='color:black;background:yellow'>            },  </span></p>

<p class=Code><span style='color:black;background:yellow'>                </span></p>

<p class=Code><span style='color:black;background:yellow'>            </span><span
style='color:green;background:yellow'>// regex taken from regex lib:
http://regexlib.com/REDetails.aspx?regexp_id=296  </span></p>

<p class=Code><span style='color:black;background:yellow'>            {</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='background:yellow'>RecognitionType<span style='color:black'>.WebPage,</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:maroon;background:yellow'>@&quot;^(https?:\/\/)?([\w\d-_]+)\.([\w\d-_\.]+)\/?\??([^#\n\r]*)?#?([^\n\r]*)&quot;</span></p>

<p class=Code><span style='color:black;background:yellow'>            }, </span></p>

<p class=Code><span style='color:black;background:yellow'>                </span></p>

<p class=Code><span style='color:black;background:yellow'>            </span><span
style='color:green;background:yellow'>// regex taken from regex lib:
http://regexlib.com/REDetails.aspx?regexp_id=247  </span></p>

<p class=Code><span style='color:black;background:yellow'>            {</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='background:yellow'>RecognitionType<span style='color:black'>.Name,</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:maroon;background:yellow'>@&quot;^([ \u00c0-\u01ffa-zA-Z'])+$&quot;</span></p>

<p class=Code><span style='color:black;background:yellow'>            },</span></p>

<p class=Code><span style='color:black;background:yellow'> </span></p>

<p class=Code><span style='color:black;background:yellow'>            {</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='background:yellow'>RecognitionType<span style='color:black'>.Number,</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:maroon;background:yellow'>@&quot;^\+?(\d[\d-. ]+)?(\([\d-.
]+\))?[\d-. ]+\d$&quot;</span></p>

<p class=Code><span style='color:black;background:yellow'>            },</span></p>

<p class=Code><span style='color:black;background:yellow'>        };</span></p>

<p class=Code><span style='color:black'>    }</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span lang=EN-US style='font-size:11.0pt;font-family:
"Calibri",sans-serif;color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span lang=EN-US
style='color:black'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='color:black'>In the CardRecognizer class
add a new static method called Recognize. This method will match the
RecognitionType to the supplied string and returns the type. </span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span lang=EN-US style='color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue;background:yellow'>using</span><span
style='background:yellow'> System.Text.RegularExpressions;</span></p>

<p class=Code><span style='color:blue;background:yellow'>&nbsp;</span></p>

<p class=Code><span style='color:blue;background:yellow'>public</span><span
style='background:yellow'> <span style='color:blue'>static</span> <span
style='color:#2B91AF'>RecognitionType</span> Recognize(<span style='color:blue'>string</span>
businessCardText)</span></p>

<p class=Code><span style='background:yellow'>        {</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:#2B91AF'>RecognitionType</span> type = <span style='color:#2B91AF'>RecognitionType</span>.Other;</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:green'>//iterate through each type to try and find a match.</span></span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:green'>// once a match is found stop and return the type</span></span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>foreach</span> (<span style='color:#2B91AF'>KeyValuePair</span>&lt;<span
style='color:#2B91AF'>RecognitionType</span>, <span style='color:blue'>string</span>&gt;
expression <span style='color:blue'>in</span> expressions)</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>if</span> (<span style='color:#2B91AF'>Regex</span>.IsMatch(businessCardText,
expression.Value))</span></p>

<p class=Code><span style='background:yellow'>                {</span></p>

<p class=Code><span style='background:yellow'>                    type =
expression.Key;</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>break</span>;</span></p>

<p class=Code><span style='background:yellow'>                }</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>return</span> (type);</span></p>

<p class=Code><span style='background:yellow'>        }</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span lang=EN-US style='font-size:11.0pt;font-family:
"Calibri",sans-serif;color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span lang=EN-US
style='color:black'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='color:black'>Build and run the
application. Select a camera and take a photo of a business card or something
that has recognizable text and click</span><span lang=EN-US style='color:black'>
“Get Details”. The OCR result will be output to the output window. The result
depends on the quality of image. No pattern matching is being used at this
point.</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span lang=EN-US style='color:black'>In
the next exercise you will use pattern matching to try and determine the
components of a business card and create a new contact card for a person in the
Windows People application.</span></p>

<span lang=EN-US style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<h1><span lang=EN-US>Exercise 3 – How to Implement and use Windows People App:</span></h1>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>With
the Recognizer Class, you can apply search patterns to the OCR-Decoded string. </span><span
style='color:black'>This exercise will create a new contact instance for the
Windows People Application.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Return to the
&quot;ApplyPatternMatching&quot; method in MainPage.xaml.cs and add the below
code. This code will create a new Contact and set the contact picture to the
image that you took from the camera feed.</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><i><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black;background:yellow'>Note: Here you are using the OCR string result
as input from previous step</span></i><i><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:black'>.</span></i></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>using</span>
Windows.ApplicationModel.Contacts;</p>

<p class=Code><span style='font-size:11.0pt'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue'>void</span>
ApplyPatternMatching(<span style='color:#2B91AF'>OcrResult</span> ocrResult)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:#2B91AF;background:yellow'>Contact</span><span
style='background:yellow'> contact = <span style='color:blue'>new</span> <span
style='color:#2B91AF'>Contact</span>();</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:green'>//set the picture</span></span></p>

<p class=Code><span style='background:yellow'>           
contact.SourceDisplayPicture = _photoFile;</span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:green'>//TODO: Loop through OCR Result lines and words</span></span></p>

<p class=Code><span style='background:yellow'> </span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:green'>//TODO: open the selection</span></span></p>

<p class=Code>        }</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>You need</span><span style='color:black'>
to pass the OCR result to a method that will iterate through all the lines and
words in that result. This method will take two parameters. The first parameter
will be the OCR Result, and the second will be an action that will be called
when a word is found.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>Add this
method in the OCR_Methods region below the &quot;ApplyPatternMatching&quot;
method.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue;background:yellow'>private</span><span
style='background:yellow'> <span style='color:blue'>void</span>
RepeatForOcrWords(<span style='color:#2B91AF'>OcrResult</span> ocrResult, <span
style='color:#2B91AF'>Action</span>&lt;<span style='color:#2B91AF'>OcrResult</span>,
<span style='color:#2B91AF'>OcrWord</span>&gt; repeater)</span></p>

<p class=Code><span style='background:yellow'>        {</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:blue'>if</span> (ocrResult.Lines != <span style='color:blue'>null</span>)</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>foreach</span> (<span style='color:blue'>var</span> line <span
style='color:blue'>in</span> ocrResult.Lines)</span></p>

<p class=Code><span style='background:yellow'>                {</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>foreach</span> (<span style='color:blue'>var</span> word <span
style='color:blue'>in</span> line.Words)</span></p>

<p class=Code><span style='background:yellow'>                    {</span></p>

<p class=Code><span style='background:yellow'>                       
repeater(ocrResult, word);</span></p>

<p class=Code><span style='background:yellow'>                    }</span></p>

<p class=Code><span style='background:yellow'>                }</span></p>

<p class=Code><span style='background:yellow'>            }</span></p>

<p class=Code><span style='background:yellow'>        }</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:10.0pt;font-family:Consolas;
color:black'>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>You now have a way to loop through the
OCR Result. You will need to call this method from the
&quot;ApplyPatternMatching&quot; method and pass through the correct
parameters. </span><span style='color:black'>Inside the
&quot;ApplyPatternMatching&quot; method replace the //TODO: Loop through… with
a call to RepeatForOcrWords method. For simplicity you will make this a
delegate call so you can implement the action here at a later date.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue'>void</span>
ApplyPatternMatching(<span style='color:#2B91AF'>OcrResult</span> ocrResult)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:#2B91AF'>Contact</span> contact = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>Contact</span>();</p>

<p class=Code>            <span style='color:green'>//set the picture</span></p>

<p class=Code>            contact.SourceDisplayPicture = photoFile;</p>

<p class=Code> </p>

<p class=Code>            <span style='background:yellow'>// this method uses
an action that will run as a 'callback' for the method</span></p>

<p class=Code><span style='color:black;background:yellow'>            </span><span
style='background:yellow'>// more info here https://msdn.microsoft.com/en-us/library/018hxwa8(v=vs.110).aspx</span></p>

<p class=Code>            <span style='color:blue;background:yellow'>this</span><span
style='background:yellow'>.RepeatForOcrWords(ocrResult, (result, word) =&gt;</span></p>

<p class=Code><span style='background:yellow'>            {</span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:green'>//TODO: RepeatForOcrWords actions goes here</span></span></p>

<p class=Code><span style='background:yellow'>            });</span></p>

<p class=Code> </p>

<p class=Code>            <span style='color:green'>//TODO: open the selection</span></p>

<p class=Code>        }</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>You still need to implement an action for when a word is found. You
are going to do this with a switch statement. The cases in your switch
statement will reflect the RecognitionTypes created in the CardRecogniser
class.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>Replace the //TODO: RepeatForOcrWords actions goes here with the
below snippet.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue'>void</span>
ApplyPatternMatching(<span style='color:#2B91AF'>OcrResult</span> ocrResult)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:#2B91AF'>Contact</span> contact = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>Contact</span>();</p>

<p class=Code>            <span style='color:green'>//set the picture</span></p>

<p class=Code>            contact.SourceDisplayPicture = _photoFile;</p>

<p class=Code> </p>

<p class=Code>            // this method uses an action that will run as a
'callback' for the method</p>

<p class=Code><span style='color:black'>            </span>// more info here
https://msdn.microsoft.com/en-us/library/018hxwa8(v=vs.110).aspx</p>

<p class=Code>            <span style='color:blue'>this</span>.RepeatForOcrWords(ocrResult,
(result, word) =&gt;</p>

<p class=Code>            {</p>

<p class=Code>                <span style='color:blue;background:yellow'>switch</span><span
style='background:yellow'> (<span style='color:#2B91AF'>CardRecognizer</span>.Recognize(word.Text))</span></p>

<p class=Code><span style='background:yellow'>                {</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>case</span> <span style='color:#2B91AF'>RecognitionType</span>.Other:</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:blue'>break</span>;</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>case</span> <span style='color:#2B91AF'>RecognitionType</span>.Email:</span></p>

<p class=Code><span style='background:yellow'>                       
contact.Emails.Add(<span style='color:blue'>new</span> <span style='color:#2B91AF'>ContactEmail</span>()
{ Address = word.Text });</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:blue'>break</span>;</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>case</span> <span style='color:#2B91AF'>RecognitionType</span>.Name:</span></p>

<p class=Code><span style='background:yellow'>                       
contact.FirstName = word.Text;</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:blue'>break</span>;</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>case</span> <span style='color:#2B91AF'>RecognitionType</span>.Number:</span></p>

<p class=Code><span style='background:yellow'>                        contact.Phones.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactPhone</span>()
{ Number = word.Text });</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:blue'>break</span>;</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>case</span> <span style='color:#2B91AF'>RecognitionType</span>.WebPage:</span></p>

<p class=Code><span style='background:yellow'>                       try</span></p>

<p class=Code><span style='color:black;background:yellow'>                      
{</span></p>

<p class=Code><span style='color:black;background:yellow'>                          
contact.Websites.Add(</span><span style='background:yellow'>new<span
style='color:black'> </span><span style='color:#2B91AF'>ContactWebsite</span><span
style='color:black'>() { Uri = </span>new<span style='color:black'> </span><span
style='color:#2B91AF'>Uri</span><span style='color:black'>(word.Text) });</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                      
}</span></p>

<p class=Code><span style='color:black;background:yellow'>                      
</span><span style='background:yellow'>catch<span style='color:black'> (</span><span
style='color:#2B91AF'>Exception</span><span style='color:black'>)</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                      
{</span></p>

<p class=Code><span style='color:black;background:yellow'>                          
</span><span style='color:#2B91AF;background:yellow'>Debug</span><span
style='color:black;background:yellow'>.WriteLine(</span><span style='color:
#A31515;background:yellow'>&quot;OCR Result cannot be converted to a URI&quot;</span><span
style='color:black;background:yellow'>);</span></p>

<p class=Code><span style='color:black;background:yellow'>                      
}</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:blue'>break</span>;</span></p>

<p class=Code><span style='background:yellow'>                    <span
style='color:blue'>default</span>:</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:blue'>break</span>;</span></p>

<p class=Code><span style='background:yellow'>                }</span></p>

<p class=Code>            });</p>

<p class=Code> </p>

<p class=Code>            <span style='color:green'>//TODO: open the selection</span></p>

<p class=Code>        }</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>With the switch statement the words found in the OCR Result are sorted
and then added to the contact appropriately. </span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>After you have iterated over the recognized
text you need to add one more validation check. For the Windows ContactManager.ShowContactCard
method to work, the contact must have at least a phone or email. Add this code
next to check these properties</span></p>

<p class=MsoNormal style='margin-left:22.25pt;vertical-align:middle'><span
style='color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue'>void</span>
ApplyPatternMatching(<span style='color:#2B91AF'>OcrResult</span> ocrResult)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:#2B91AF'>Contact</span> contact = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>Contact</span>();</p>

<p class=Code>            <span style='color:green'>//set the picture</span></p>

<p class=Code>            contact.SourceDisplayPicture = _photoFile;</p>

<p class=Code> </p>

<p class=Code>            <span style='color:blue'>this</span>.RepeatForOcrWords(ocrResult,
(result, word) =&gt;</p>

<p class=Code>            {</p>

<p class=Code>                <span style='color:blue'>switch</span> (<span
style='color:#2B91AF'>CardRecogniser</span>.Recognise(word.Text))</p>

<p class=Code>                {</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Other:</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Email:</p>

<p class=Code>                        contact.Emails.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactEmail</span>()
{ Address = word.Text });</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Name:</p>

<p class=Code>                        contact.FirstName = word.Text;</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Number:</p>

<p class=Code>                        contact.Phones.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactPhone</span>()
{ Number = word.Text });</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.WebPage:</p>

<p class=Code>                        contact.Websites.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactWebsite</span>()
{ Uri = <span style='color:blue'>new</span> <span style='color:#2B91AF'>Uri</span>(word.Text)
});</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>default</span>:</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                }</p>

<p class=Code>            });</p>

<p class=Code> </p>

<p class=Code>            <span style='color:blue;background:yellow'>if</span><span
style='color:black;background:yellow'> (!contact.Phones.Any()) </span><span
style='background:yellow'>//contact must have either a phone or email when
calling ContactManager.ShowContactCard.</span></p>

<p class=Code><span style='color:black;background:yellow'>            {</span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:blue;background:yellow'>if</span><span style='color:black;
background:yellow'> (!contact.Emails.Any())</span></p>

<p class=Code><span style='color:black;background:yellow'>                {</span></p>

<p class=Code><span style='color:black;background:yellow'>                    </span><span
style='color:#2B91AF;background:yellow'>Debug</span><span style='color:black;
background:yellow'>.WriteLine(</span><span style='color:#A31515;background:
yellow'>&quot;Contact must have phone or email info.&quot;</span><span
style='color:black;background:yellow'>);</span></p>

<p class=Code><span style='color:black;background:yellow'> </span></p>

<p class=Code><span style='color:black;background:yellow'>                    </span><span
style='color:blue;background:yellow'>return</span><span style='color:black;
background:yellow'>;</span></p>

<p class=Code><span style='color:black;background:yellow'>                }</span></p>

<p class=Code><span style='color:black;background:yellow'>            }</span></p>

<p class=Code><span style='color:black'>&nbsp;</span></p>

<p class=Code><span style='color:green'>            //</span>TODO: open the
selection</p>

<p class=Code>        }</p>

<p class=MsoNormal style='margin-left:22.25pt;vertical-align:middle'><span
style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:22.25pt;vertical-align:middle'><span
style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Finally you need to open the contact in
the Windows People Application. </span><span style='color:black'>Create a new
method called GetElementRect in the HelpersMethods region. This method helps to
define the point where to open the Contact Manager</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=Code><a name="OLE_LINK7"></a><a name="OLE_LINK6"><span
style='background:yellow'>//get the bounding rect of an element relative to 0,0</span></a></p>

<p class=Code><span style='color:black;background:yellow'>        </span><span
style='color:blue;background:yellow'>private</span><span style='color:black;
background:yellow'> </span><span style='color:blue;background:yellow'>static</span><span
style='color:black;background:yellow'> </span><span style='color:#2B91AF;
background:yellow'>Rect</span><span style='color:black;background:yellow'>
GetElementRect(</span><span style='color:#2B91AF;background:yellow'>FrameworkElement</span><span
style='color:black;background:yellow'> element)</span></p>

<p class=Code><span style='color:black;background:yellow'>        {</span></p>

<p class=Code><span style='color:black;background:yellow'>            </span><span
style='background:yellow'>//get the element point to open the window at the
correct point</span></p>

<p class=Code><span style='color:black;background:yellow'>            </span><span
style='color:#2B91AF;background:yellow'>GeneralTransform</span><span
style='color:black;background:yellow'> transform = element.TransformToVisual(</span><span
style='color:blue;background:yellow'>null</span><span style='color:black;
background:yellow'>);</span></p>

<p class=Code><span style='color:black;background:yellow'>            </span><span
style='color:#2B91AF;background:yellow'>Point</span><span style='color:black;
background:yellow'> point = transform.TransformPoint(</span><span
style='color:blue;background:yellow'>new</span><span style='color:black;
background:yellow'> </span><span style='color:#2B91AF;background:yellow'>Point</span><span
style='color:black;background:yellow'>());</span></p>

<p class=Code><span style='color:black;background:yellow'> </span></p>

<p class=Code><span style='color:black;background:yellow'>            </span><span
style='color:blue;background:yellow'>return</span><span style='color:black;
background:yellow'> </span><span style='color:blue;background:yellow'>new</span><span
style='color:black;background:yellow'> </span><span style='color:#2B91AF;
background:yellow'>Rect</span><span style='color:black;background:yellow'>(point,
</span><span style='color:blue;background:yellow'>new</span><span
style='color:black;background:yellow'> </span><span style='color:#2B91AF;
background:yellow'>Size</span><span style='color:black;background:yellow'>(element.ActualWidth,
element.ActualHeight));</span></p>

<p class=Code><span style='color:black;background:yellow'>        }</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>In the &quot;ApplyPatternMatching&quot; method, replace the
//TODO: open the selection with the below code snippet.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>This code will call the GetElementRect to get the correct location
to open the contact manager and then call ShowContactCard to display the
contact.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>private</span> <span style='color:blue'>void</span>
ApplyPatternMatching(<span style='color:#2B91AF'>OcrResult</span> ocrResult)</p>

<p class=Code>        {</p>

<p class=Code>            <span style='color:#2B91AF'>Contact</span> contact = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>Contact</span>();</p>

<p class=Code>            <span style='color:green'>//set the picture</span></p>

<p class=Code>            contact.SourceDisplayPicture = _photoFile;</p>

<p class=Code> </p>

<p class=Code>            // this method uses an action that will run as a
'callback' for the method</p>

<p class=Code><span style='color:black'>            </span>// more info here
https://msdn.microsoft.com/en-us/library/018hxwa8(v=vs.110).aspx</p>

<p class=Code>            <span style='color:blue'>this</span>.RepeatForOcrWords(ocrResult,
(result, word) =&gt;</p>

<p class=Code>            {</p>

<p class=Code>                <span style='color:blue'>switch</span> (<span
style='color:#2B91AF'>CardRecogniser</span>.Recognise(word.Text))</p>

<p class=Code>                {</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Other:</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Email:</p>

<p class=Code>                        contact.Emails.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactEmail</span>()
{ Address = word.Text });</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Name:</p>

<p class=Code>                        contact.FirstName = word.Text;</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Number:</p>

<p class=Code>                        contact.Phones.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactPhone</span>()
{ Number = word.Text });</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.WebPage:</p>

<p class=Code>                        contact.Websites.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactWebsite</span>()
{ Uri = <span style='color:blue'>new</span> <span style='color:#2B91AF'>Uri</span>(word.Text)
});</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>default</span>:</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                }</p>

<p class=Code>            });</p>

<p class=Code> </p>

<p class=Code>            <a name="OLE_LINK5"></a><a name="OLE_LINK4"></a><a
name="OLE_LINK3"><span style='color:blue'>if</span> (!contact.Phones.Any()) <span
style='color:green'>//contact must have either a phone or email when calling
ContactManager.ShowContactCard.</span></a></p>

<p class=Code>            {</p>

<p class=Code>                <span style='color:blue'>if</span>
(!contact.Emails.Any())</p>

<p class=Code>                {</p>

<p class=Code>                    <span style='color:#2B91AF'>Debug</span><span
style='color:black'>.WriteLine(</span><span style='color:#A31515'>&quot;Contact
must have phone or email info.&quot;</span><span style='color:black'>);</span></p>

<p class=Code>                    <span style='color:blue'>return</span>;</p>

<p class=Code>                }</p>

<p class=Code>            }</p>

<p class=Code> </p>

<p class=Code>            <span style='color:#2B91AF;background:yellow'>Rect</span><span
style='background:yellow'> rect = GetElementRect(GetDetailsButton);</span></p>

<p class=Code><span style='background:yellow'>            <span
style='color:#2B91AF'>ContactManager</span>.ShowContactCard(contact, rect,
Windows.UI.Popups.<span style='color:#2B91AF'>Placement</span>.Default);</span></p>

<p class=Code>        }</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Build and Run the application (F5).
Select a camera and take a photo of a business card. Click get details. You
will see a popup window showing the contact card. </span><span
style='color:black'>You can click on &quot;Open Contact&quot;, here you will
have the ability to save the contact, or edit details then save the contact.</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'><img width=602 height=453 id="Picture 18"
src="How%20To%20Build%20Card%20Reader_files/image010.png"></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>If you find that the app crashes in the ApplyPatternMatching
method, it is likely due to the regex failing to correctly identify a component
of the business card for the Contact.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>In the next exercise you will explore how to extend the regex
expressions to cover additional scenarios.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><b><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'><br>
<br>
</span></b></p>

<span style='font-size:16.0pt;line-height:107%;font-family:"Calibri Light",sans-serif;
color:#2E74B5'><br clear=all style='page-break-before:always'>
</span>

<h1>Exercise 4 - Additional Exercises:</h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>While the
&quot;ApplyPatternMatching&quot; method may work well for very simple data,
using OCR can require some complicated regex to validate words. </span><span
style='color:black'>With OCR a phone number that is separated by spaces will be
returned in the OCR result as separate strings. This will break your current
code for Phone numbers.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>In
order to get the correct phone number into the contact information more code
needs to be implemented.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>In the
CardRecognizer class and in RecognitionType you may have noticed PhoneNumber.
However you did not implement any Regex code for this, let's do that now.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><b><span style='color:black'>Please
note:</span></b><span style='color:black'> The PhoneNumber must be listed in
the enum before the Number type. A number will always validate as a number but
not always as a phone number, you need to check if it is a phone number first,
and then if it is a number.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>public</span><span style='color:black'> </span><span
style='color:blue'>enum</span><span style='color:black'> </span>RecognitionType</p>

<p class=Code><span style='color:black'>    {</span></p>

<p class=Code><span style='color:black'>        Other,</span></p>

<p class=Code><span style='color:black'>        Email,</span></p>

<p class=Code><span style='color:black'>        WebPage,</span></p>

<p class=Code><span style='color:black'>        Name,</span></p>

<p class=Code><span style='color:black'>        <span style='background:yellow'>PhoneNumber,</span></span></p>

<p class=Code><span style='color:black'>        Number,</span></p>

<p class=Code><span style='color:black'>    }</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:10.0pt;font-family:Consolas;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>static</span><span style='color:black'> </span>Dictionary<span
style='color:black'>&lt;</span>RecognitionType<span style='color:black'>, </span><span
style='color:blue'>string</span><span style='color:black'>&gt; expressions = </span><span
style='color:blue'>new</span><span style='color:black'> </span>Dictionary<span
style='color:black'>&lt;</span>RecognitionType<span style='color:black'>, </span><span
style='color:blue'>string</span><span style='color:black'>&gt;()</span></p>

<p class=Code><span style='color:black'>        {  </span></p>

<p class=Code><span style='color:black'>            </span><span
style='color:green'>// regex taken from MSDN: http://msdn.microsoft.com/en-us/library/01escwtf(v=vs.110).aspx 
</span></p>

<p class=Code><span style='color:black'>            {</span></p>

<p class=Code><span style='color:black'>                </span>RecognitionType<span
style='color:black'>.Email,</span></p>

<p class=Code><span style='color:black'>                </span><span
style='color:maroon'>@&quot;^(?(&quot;&quot;)(&quot;&quot;.+?(?&lt;!\\)&quot;&quot;@)|(([0-9a-z]((\.(?!\.))|[-!#\$%&amp;'\*\+/=\?\^`\{\}\|~\w])*)(?&lt;=[0-9a-z])@))&quot;</span><span
style='color:black'>+</span></p>

<p class=Code><span style='color:black'>                </span><span
style='color:maroon'>@&quot;(?(\[)(\[(\d{1,3}\.){3}\d{1,3}\])|(([0-9a-z][-\w]*[0-9a-z]*\.)+[a-z0-9][\-a-z0-9]{0,22}[a-z0-9]))$&quot;</span></p>

<p class=Code><span style='color:black'>            },  </span></p>

<p class=Code><span style='color:black'>                </span></p>

<p class=Code><span style='color:black'>            </span><span
style='color:green'>// regex taken from regex lib:
http://regexlib.com/REDetails.aspx?regexp_id=296  </span></p>

<p class=Code><span style='color:black'>            {</span></p>

<p class=Code><span style='color:black'>                </span>RecognitionType<span
style='color:black'>.WebPage,</span></p>

<p class=Code><span style='color:black'>                </span><span
style='color:maroon'>@&quot;^(https?:\/\/)?([\w\d-_]+)\.([\w\d-_\.]+)\/?\??([^#\n\r]*)?#?([^\n\r]*)&quot;</span></p>

<p class=Code><span style='color:black'>            }, </span></p>

<p class=Code><span style='color:black'>                </span></p>

<p class=Code><span style='color:black'>            </span><span
style='color:green'>// regex taken from regex lib:
http://regexlib.com/REDetails.aspx?regexp_id=247  </span></p>

<p class=Code><span style='color:black'>            {</span></p>

<p class=Code><span style='color:black'>                </span>RecognitionType<span
style='color:black'>.Name,</span></p>

<p class=Code><span style='color:black'>                </span><span
style='color:maroon'>@&quot;^([ \u00c0-\u01ffa-zA-Z'])+$&quot;</span></p>

<p class=Code><span style='color:black'>            },</span></p>

<p class=Code><span style='color:black'> </span></p>

<p class=Code><span style='color:black'>            <span style='background:
yellow'>{</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='background:yellow'>RecognitionType<span style='color:black'>.PhoneNumber,</span></span></p>

<p class=Code><span style='color:black;background:yellow'>                </span><span
style='color:maroon;background:yellow'>@&quot;(((\+[0-9]{1,2}|00[0-9]{1,2})[-\
.]?)?)(\d[-\ .]?){5,15}&quot;</span></p>

<p class=Code><span style='color:black;background:yellow'>            },</span></p>

<p class=Code><span style='color:black'> </span></p>

<p class=Code><span style='color:black'>            {</span></p>

<p class=Code><span style='color:black'>                </span>RecognitionType<span
style='color:black'>.Number,</span></p>

<p class=Code><span style='color:black'>                </span><span
style='color:maroon'>@&quot;^\+?(\d[\d-. ]+)?(\([\d-. ]+\))?[\d-. ]+\d$&quot;</span></p>

<p class=Code><span style='color:black'>            },</span></p>

<p class=Code><span style='color:black'>        };</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>Update the switch statement inside the
&quot;ApplyPatternMatching&quot; method in MainPage.xaml.cs. </span><span
style='color:black'>As OCR splits phone numbers that contain spaces you will
need to put these separate string values back together. You will do this by
declaring a private string variable phoneNumber at the top of MainPage class.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-bottom:0cm;margin-bottom:
.0001pt;line-height:normal;vertical-align:middle'><span style='color:black'>&nbsp;</span></p>

<p class=MsoListParagraphCxSpLast style='margin-bottom:0cm;margin-bottom:.0001pt;
line-height:normal;vertical-align:middle'><span style='color:black'>When the
OCR result returns and is of type Number, that number should be appended to the
phoneNumber variable. As you append numbers you can check if the phoneNumber
value validates as a phone number. If it does, then add the phone number to the
contact details.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='font-size:11.0pt;color:black'>&nbsp;</span>public<span
style='color:black'> </span>sealed<span style='color:black'> </span>partial<span
style='color:black'> </span>class<span style='color:black'> </span><span
style='color:#2B91AF'>MainPage</span><span style='color:black'> : </span><span
style='color:#2B91AF'>Page</span></p>

<p class=Code><span style='color:black'>    {</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>DeviceInformationCollection</span><span
style='color:black'> _allVideoDevices;</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>DeviceInformation</span><span
style='color:black'> _desiredDevice;</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>MediaCapture</span><span
style='color:black'> _mediaCapture;</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>StorageFile</span><span
style='color:black'> _photoFile;</span></p>

<p class=Code><span style='color:black'>        </span>private<span
style='color:black'> </span><span style='color:#2B91AF'>OcrEngine</span><span
style='color:black'> _ocrEngine;</span></p>

<p class=Code><span style='color:blue;background:yellow'>private</span><span
style='background:yellow'> <span style='color:blue'>string</span> _phoneNumber
= <span style='color:blue'>string</span>.Empty;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:10.0pt;font-family:Consolas;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>this</span>.RepeatForOcrWords(ocrResult,
(result, word) =&gt;</p>

<p class=Code>            {</p>

<p class=Code>                <span style='color:blue'>switch</span> (<span
style='color:#2B91AF'>CardRecogniser</span>.Recognise(word.Text))</p>

<p class=Code>                {</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Other:</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Email:</p>

<p class=Code>                        contact.Emails.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactEmail</span>()
{ Address = word.Text });</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Name:</p>

<p class=Code>                        contact.FirstName = word.Text;</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Number:</p>

<p class=Code>                        <span style='color:green;background:yellow'>//NOTE:
Phone numbers are not as easy to validate because OCR results splits the numbers
if they contain spaces.</span></p>

<p class=Code><span style='background:yellow'>                        _phoneNumber
+= word.Text;</span></p>

<p class=Code><span style='background:yellow'>                        </span><span
style='font-family:Consolas;color:#2B91AF;background:yellow'>RecognitionType</span><span
style='font-family:Consolas;color:black;background:yellow'> </span><span
style='background:yellow'>type = <span style='color:#2B91AF'>CardRecogniser</span>.Recognise(_phoneNumber);</span></p>

<p class=Code><span style='background:yellow'>                        <span
style='color:blue'>if</span> (type == <span style='color:#2B91AF'>RecognitionType</span>.PhoneNumber)</span></p>

<p class=Code><span style='background:yellow'>                        {</span></p>

<p class=Code><span style='background:yellow'>                           
contact.Phones.Add(<span style='color:blue'>new</span> <span style='color:#2B91AF'>ContactPhone</span>()
{ Number = _phoneNumber });</span></p>

<p class=Code><span style='background:yellow'>                        }</span></p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.WebPage:</p>

<p class=Code>                        contact.Websites.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactWebsite</span>()
{ Uri = <span style='color:blue'>new</span> <span style='color:#2B91AF'>Uri</span>(word.Text)
});</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>default</span>:</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                }</p>

<p class=Code>            });</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-bottom:0cm;margin-bottom:.0001pt;
text-indent:-18.0pt;line-height:normal;vertical-align:middle'><span
style='color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>More logic is needed to determine if
numbers are concurrent, or if they are split by words. </span><span
style='color:black'>To achieve this simply use a boolean to determine if the
OCR result is a number or not. </span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>By default the boolean will be false each time the switch
statement is run. If a number is found set the value to true and check if it is
a phone number. At the end of the switch statement if the boolean is still
false then a number has not been found, so you should clear the phoneNumber
value and start again.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>this</span>.RepeatForOcrWords(ocrResult,
(result, word) =&gt;</p>

<p class=Code>            {</p>

<p class=Code>                <span style='color:blue;background:yellow'>bool</span><span
style='background:yellow'> isNumber = <span style='color:blue'>false</span>;</span></p>

<p class=Code> </p>

<p class=Code>                <span style='color:blue'>switch</span> (<span
style='color:#2B91AF'>CardRecogniser</span>.Recognise(word.Text))</p>

<p class=Code>                {</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Other:</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Email:</p>

<p class=Code>                        contact.Emails.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactEmail</span>()
{ Address = word.Text });</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Name:</p>

<p class=Code>                        contact.FirstName = word.Text;</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.Number:</p>

<p class=Code>                        <span style='background:yellow'>isNumber
= <span style='color:blue'>true</span>;</span></p>

<p class=Code>                        <span style='color:green'>//NOTE: Phone
numbers are not as easy to validate because OCR results splits the numbers if
they contain spaces.</span></p>

<p class=Code>                        _phoneNumber += word.Text;</p>

<p class=Code>                        <span style='color:blue'>var</span> type
= <span style='color:#2B91AF'>CardRecogniser</span>.Recognise(_phoneNumber);</p>

<p class=Code>                        <span style='color:blue'>if</span> (type
== <span style='color:#2B91AF'>RecognitionType</span>.PhoneNumber)</p>

<p class=Code>                        {</p>

<p class=Code>                            contact.Phones.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactPhone</span>()
{ Number = _phoneNumber });</p>

<p class=Code>                        }</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>case</span> <span
style='color:#2B91AF'>RecognitionType</span>.WebPage:</p>

<p class=Code>                        contact.Websites.Add(<span
style='color:blue'>new</span> <span style='color:#2B91AF'>ContactWebsite</span>()
{ Uri = <span style='color:blue'>new</span> <span style='color:#2B91AF'>Uri</span>(word.Text)
});</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                    <span style='color:blue'>default</span>:</p>

<p class=Code>                        <span style='color:blue'>break</span>;</p>

<p class=Code>                }</p>

<p class=Code> </p>

<p class=Code>                <span style='color:green;background:yellow'>//Encounted
a word or a value other than a number. </span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:green'>//If we havent validated as a phone number at this stage it
is clearly not a phone number so clear the string</span></span></p>

<p class=Code><span style='background:yellow'>                <span
style='color:blue'>if</span> (!isNumber)</span></p>

<p class=Code><span style='background:yellow'>                {</span></p>

<p class=Code><span style='background:yellow'>                   _phoneNumber =
</span><span lang=EN-US style='font-size:9.5pt;font-family:Consolas;color:blue;
background:yellow'>string</span><span lang=EN-US style='font-size:9.5pt;
font-family:Consolas;color:black;background:yellow'>.Empty</span><span
style='background:yellow'>;</span></p>

<p class=Code><span style='background:yellow'>                }</span></p>

<p class=Code>            });</p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:22.25pt;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:22.25pt;margin-bottom:.0001pt;text-indent:-18.0pt;line-height:normal;
vertical-align:middle'><span style='color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='color:black'>This is a quick solution to finding Phone
numbers in OCR Results, see if you can come up with a better solution or try
and resolve a street address from separate OCR results. </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal>In this exercise you learned how to use a webcam to capture
an image, recognize text in the image, and then use the text to create a
contact in the Windows People application.</p>

<p class=MsoNormal>In order to make this into a commercial application you
would need to work on the text recognition categorization for a contact.</p>

</div>

</body>

</html>
